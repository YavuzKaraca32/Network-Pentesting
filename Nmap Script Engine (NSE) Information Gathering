NMAP-ACTIVE INFO GATHERING

only use against VMware VMs
otherwise on target systems may be collapsed-data loss-locked (breaking the law!!!)
==============================================================
Nmap Script Engines (NSE) written in Lua language

sudo nmap --script-updatedb

network discovery-enumeration (whois-smb shares-snmp queries etc)
more sophisticated version detection
vuln detection and exploitation
backdoor detection

/usr/share/nmap/scripts
locate *.nse | grep ssh

less -N script.db 

Before Using any NSE, review and provide proper args (if needed)
------------------------------------------------------------------------------------
(built-in help menu)
nmap --script-help whois-ip.nse
nmap -v --script-help smtp-enum-users.nse 

cat  /usr/share/nmap/scripts/whois-ip.nse (Description - Usage examples / --script-args ?
less  /usr/share/nmap/scripts/whois-ip.nse
more  /usr/share/nmap/scripts/whois-ip.nse
==================================================================

-sC  /  --script=default (default scripts)

locate *.nse | more

locate *.nse | grep whois

which category or .nse to use ?    

safe: not stop system, no exploit usage

nmap --script "default and safe"

nmap --script telnet-brute

nmap --script smb-check-vulns --script-args=unsafe=1

nmap --script=vuln 192.168.133.132 (detectable)

nmap -p21 --script "ftp-*" 192.168.133.132

nmap -v --script=banner 192.168.133.138

-----------------------------------------------
SMB Enumeration with NSE

locate *smb*.nse

nmap --script nbstat 192.168.133.136 -p445

nmap --script smb-security-mode 192.168.133.136 -p445

nmap --script smb-enum-users 192.168.133.136 -p445 -d  (debug-more detail about errors)

nmap --script smb-enum-shares 192.168.133.136 -p445

nmap --script smb-enum-shares  --script-args smbuser=administrator,smbpass=vagrant 192.168.133.136 -p445

nmap --script=smb-os-discovery.nse 192.168.133.132 -p44

nmap --script=smb-brute 192.168.133.132 -p445 (takes 5` minute)

nmap --script smb-enum-shares  --script-args smbuser='',smbpass='' 192.168.133.132 -p445 (Null session)  
 
nmap --script smb-enum-shares  --script-args smbuser='vagrant',smbpass='vagrant' 192.168.133.136 -p445  (Meta3)

nmap --script smb-vuln-ms17-010 192.168.133.136 -p445 (meta3)
================================================================================

SSH Enumeration with NSE

nmap   -p22 192.168.133.132-136 --script banner

nmap   -p22 192.168.133.132-136 --script ssh-auth-methods

==============================================
HTTP Enumeration with NSE

nmap -p- 192.168.133.136 -T4 -sV  (find http ports first)

nmap -p 8080,80,443,8009 192.168.133.132,136 -T4 -sV --script http-methods
