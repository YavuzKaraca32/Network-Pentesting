ATTENTION!:
Do not use Nessus against any real target-web site; 
use just against Metasploitable2 !!!
------------------------------------------------------------------------------------------------------------------------

Pentest vs Vuln Scanning ? (not alternative; complimentary for each other)
Pentest: by simulating an attacker to detec vulns
Vuln Scan: finding known vulns; whose plugins are available
----------------------------------------------------------------------------------------

Vulnerability; possibility of weakness in assests/systems that can be exploited by threats

vuln assessment x vuln scanning (can be used interchangeably sometimes!)

Define the vulnerability management policy (Inc Compliance Requirements);
-frequency of scanning
-prioritization and grouping of assests (server-end point-printest-VoIP etc)

Remediation-Hardening (how to handle vulns)
------------------------------------------------------------
-disable/close/terminate; unnecessary ports-services-applications-permissions-privileges (enough is enough)
-update or upgrade system/application if a vendor solution is available
-restrict or limit the access to the service or device (last resort  if required)
-segregate or move the assest in a more segmented secure network
-if risk acceptance - register it for exception

Manuel Vuln Scanning vs Automated Vuln Scanning (with tools like Nessus, OpenVAS etc)
Automated vuln scanning first then manuel scanning to validate findings (most critical servers with manuel scanning)
Detected vuln/misconfigured services - search exploits for vulns -assess all information obtained from info gathering/scanning/enumeration
 
follow easy target-then difficult targets methodology/pattern

Vulnerability discover methods
-----------------------------------------
banner grabbing and version detections
protocol-service version detection
application behaviour analyses 

Vulnerability Assessment
---------------------------------------
A vulnerability assessment is the process of identifying, quantifying, and prioritizing 
(or ranking) the vulnerabilities in a system.

Penetration Test
-------------------------
A penetration test, an authorized simulated cyberattack on a computer system to identify weaknesses/vulnerabilities, including the potential for unauthorized parties to gain access to the system

Vulnerability Management
------------------------------------
The "cyclical processes of identifying, classifying, prioritizing, remediating and mitigating" software vulnerabilities.
Vulnerabilities can be discovered with a vulnerability scanner, which analyzes a 
computer system in search of known vulnerabilities by using its plugins (scripts)


Vuln Assessment Phases
---------------------------------------
Assessment of pysical security and posture (Inc access to system room/data center etc)
Check for misconfiguration and human errors
Conduct vuln scannning
Identify and prioritize vulns
Identify false positive and false negatives
Apply business (client`s priorities) and techonolgy context to results
Perform OSINT information gathering to validate the vuln scan results 
Create a vuln scan report (use results as a guide for system/network admins and adjust accordingly)

When been applied by System/Network/Patch Management people, 
--------------------------------------------------------------------------------------------
provide clear instructions and specific solutions for the targets
provide workaround and/or mid-long term options

=======================================================
Validating Scan Reports
---------------------------------
▪ Reconcile results because scanners can misinterpret the information, they receive from their probes 
▪ Correlate the scan results with other data sources by reviewing related system and network logs 
▪ Compare the results to best practices to determine if they are a high priority or a low risk
▪ Identify exceptions for findings whose risk has been accepted or transferred

=========================
Types of Vuln Assesments
-------------------------------------
-Passive Scanning:analyzes only intercepted network traffic rather than sending probes to a target 
-Active Scanning:analyzes the responses from probes sent to a target 
▪ Active scanning consumes network bandwidth and processor resources 
▪ Active scanning can be configured as a credentialed, non-credentialed, /server-based, or agent-based scan

-----------------------------------
-Credentialed Scan: vuln scanner is given a user account to log-on to the target systems or hosts
▪Credentialed scanning is likely to find vulnerabilities and misconfigurations 
▪ Credentialed scans can usually discover more vulnerabilities than a non credentialed scan

-Non-credentialed Scan: vuln scanner sends test packets without logging onto the system or host 
▪ Non-credentialed scans probe a target with default passwords and for vulns within applications
▪ more appropriate for external assessment of the network perimete

----------------------------------------------
- Server-based Scanning:vuln scanning is launched from scanning servers against the targets
- Agent-based Scanning:vuln scanning is conducted using a software application installed locally on each target 
▪ Agents are managed by an administration server and scans are run according to a set schedule (+)
▪ Agent-based scanning reduces the impact on the network/chance of service outages (+)
▪ Agent-based scanning is better for mobile or remote devices when offline (+)
▪ Agents are limited to a particular operating system (-)
▪ Agent software could be compromised by malware (-)

Source code analysis (white box pentest)
static or dynamic code analysis (manuel or automated) (IBM AppScan, AppSweep, CodeScan etc)
-----------------------------------------------------------------------

Common Vulnerability Scoring System-CVSS
----------------------------------------------------------------

=======================
Vulnerability Feeds
------------------------------------
- It is a synchronized list of data and scripts used to check for vulnerabilities, also known as plug-ins or network vulnerability tests (NVTs) 

- Many commercial vulnerability scanners require an ongoing paid subscription to access feeds

- Security Content Automation Protocol (SCAP)
	▪ A NIST framework - outlines various accepted practices for automating vulnerability scanning by adhering to standards 
	▪ SCAP is used to uphold internal and external compliance requirements 

- Open Vulnerability and Assessment Language (OVAL)
	▪ An XML schema for describing system security state and querying vulnerability reports and information 

- Extensible Configuration Checklist Description Format (XCCDF)
	▪ An XML schema for developing and auditing best-practice configuration checklists and rules

========================
Common Identifiers
-----------------------------------
- Important that different scanning tools can identify the same vulnerabilities and platforms consistently 
▪ CVE
▪ NVD
▪ CWE
▪ CAPEC
▪ CPE
▪ CCE 

- Common Vulnerabilities and Exposures (CVE)
	▪ A commonly used scheme for identifying vulnerabilities developed by MITRE and adopted by NIST 
	▪ Each vulnerability has an identifier that is in the format of CVE-YYYY-#### 

- National Vulnerability Database (NVD)
	▪ A superset of the CVE database, maintained by NIST, that contains additional information such as analysis, criticality metrics (CVSS), and fix 
information or instructions 

- Common Attack Pattern Enumeration and Classification (CAPEC)
	▪ A knowledge base maintained by MITRE that classifies specific attack patterns focused on application security and exploit techniques 
	▪ ATT&CK is a tool for understanding adversary behaviors within a network intrusion event 

- Common Platform Enumeration (CPE)
	▪ Scheme for identifying hardware devices, operating systems, and applications 
	• cpe:/{part}:{vendor}: 
	  {product}:{version}: 
	  {update}:{edition}:{language}


- Common Configuration Enumeration (CCE)
	▪ Scheme for provisioning secure configuration checks across multiple sources
	▪ CCE is a collection of configuration best-practice statement
